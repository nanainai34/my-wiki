// ページ読み込み時に投稿内容を表示する
window.onload = function() {
    displaySection("history");
    displaySection("government");
    displaySection("culture");
    displayComments();
};

// セクションを切り替える関数
function displaySection(sectionId) {
    let sections = document.querySelectorAll('.content-section');
    sections.forEach(section => {
        section.style.display = 'none';
    });
    document.getElementById(sectionId).style.display = 'block';
}

// 投稿内容を保存する関数
function saveComment(sectionId) {
    let name = document.getElementById(sectionId + "-name").value;
    let comment = document.getElementById(sectionId + "-comment").value;

    let comments = JSON.parse(localStorage.getItem(sectionId + "-comments")) || [];
    let newComment = { name: name, comment: comment };
    comments.push(newComment);
    localStorage.setItem(sectionId + "-comments", JSON.stringify(comments));

    // 表示更新
    displayComments();
}

// 投稿内容を表示する関数
function displayComments() {
    let commentList = document.getElementById("comment-list");
    commentList.innerHTML = ""; // 現在の内容をクリア

    // 各セクションのコメントを取得して表示
    ["history", "government", "culture"].forEach(sectionId => {
        let comments = JSON.parse(localStorage.getItem(sectionId + "-comments")) || [];
        comments.forEach(comment => {
            let listItem = document.createElement("li");
            listItem.textContent = `${comment.name}: ${comment.comment}`;
            commentList.appendChild(listItem);
        });
    });
}

// 各フォームのコメント投稿ボタンにイベントリスナーを設定する
document.getElementById("history-form").addEventListener("submit", function(event) {
    event.preventDefault();
    saveComment("history");
});

document.getElementById("government-form").addEventListener("submit", function(event) {
    event.preventDefault();
    saveComment("government");
});

document.getElementById("culture-form").addEventListener("submit", function(event) {
    event.preventDefault();
    saveComment("culture");
});
// コメントを保存する関数
function saveComment(sectionId) {
    let name = document.getElementById(sectionId + "-name").value;
    let comment = document.getElementById(sectionId + "-comment").value;

    // ローカルストレージに保存する例
    let comments = JSON.parse(localStorage.getItem(sectionId + "-comments")) || [];
    let newComment = { name: name, comment: comment };
    comments.push(newComment);
    localStorage.setItem(sectionId + "-comments", JSON.stringify(comments));

    // コメントを表示する
    displayComments(sectionId);
}

// コメントを表示する関数
function displayComments(sectionId) {
    let commentList = document.createElement("ul");
    commentList.id = sectionId + "-comment-list";
    let panel = document.getElementById(sectionId + "-panel");
    panel.innerHTML = ""; // コメントをクリア

    // ローカルストレージからコメントを取得して表示
    let comments = JSON.parse(localStorage.getItem(sectionId + "-comments")) || [];
    comments.forEach(comment => {
        let listItem = document.createElement("li");
        listItem.textContent = `${comment.name}: ${comment.comment}`;
        commentList.appendChild(listItem);
    });

    panel.appendChild(commentList); // コメントリストを追加
}

// フォームの送信イベントリスナーを設定する関数
function setupFormSubmit(formId, sectionId) {
    document.getElementById(formId).addEventListener("submit", function(event) {
        event.preventDefault();
        saveComment(sectionId);
    });
}

// 各セクションのコメントフォームに送信イベントリスナーを設定
setupFormSubmit("history-form", "history");
setupFormSubmit("government-form", "government");
setupFormSubmit("culture-form", "culture");

// 画像をアップロードする関数
function uploadPhoto() {
    let name = document.getElementById("photo-name").value;
    let file = document.getElementById("photo-file").files[0];

    // サーバーサイドにファイルをアップロードする処理を実装する必要があります

    // アップロードした画像を表示する（仮の表示方法）
    let photoGallery = document.getElementById("photo-gallery");
    let img = document.createElement("img");
    img.src = URL.createObjectURL(file);
    img.alt = name;
    photoGallery.appendChild(img);
}

// フォームの送信イベントリスナーを設定（写真のアップロード）
document.getElementById("photo-form").addEventListener("submit", function(event) {
    event.preventDefault();
    uploadPhoto();
});

// コメントを投稿する関数
function postComment() {
    let name = document.getElementById("comment-name").value;
    let comment = document.getElementById("comment-content").value;

    // サーバーサイドでコメントを保存する処理を実装する必要があります

    // 投稿したコメントを表示する（仮の表示方法）
    let commentList = document.getElementById("comment-list");
    let listItem = document.createElement("li");
    listItem.textContent = `${name}: ${comment}`;
    commentList.appendChild(listItem);
}

// フォームの送信イベントリスナーを設定（コメントを投稿）
document.getElementById("comment-form").addEventListener("submit", function(event) {
    event.preventDefault();
    postComment();
});
// ページが読み込まれたときに実行される初期化関数
document.addEventListener('DOMContentLoaded', function() {
    // サンプルデータを表示する
    displayHistoryPosts();
    displayGovernmentPosts();
    displayCulturePosts();
    displayPhotoGallery();
    displayComments();

    // 各フォームの送信イベントを設定する
    document.getElementById('history-form').addEventListener('submit', addHistoryComment);
    document.getElementById('government-form').addEventListener('submit', addGovernmentComment);
    document.getElementById('culture-form').addEventListener('submit', addCultureComment);
    document.getElementById('photo-form').addEventListener('submit', uploadPhoto);
    document.getElementById('comment-form').addEventListener('submit', addComment);
});

// 歴史セクションの投稿を表示する関数
function displayHistoryPosts() {
    let historyPanel = document.getElementById('history-panel');
    historyPanel.innerHTML = '';
    historyPosts.forEach(post => {
        let div = document.createElement('div');
        div.innerHTML = `<p><strong>${post.name}</strong>: ${post.comment}</p>`;
        historyPanel.appendChild(div);
    });
}

// 政府セクションの投稿を表示する関数
function displayGovernmentPosts() {
    let governmentPanel = document.getElementById('government-panel');
    governmentPanel.innerHTML = '';
    governmentPosts.forEach(post => {
        let div = document.createElement('div');
        div.innerHTML = `<p><strong>${post.name}</strong>: ${post.comment}</p>`;
        governmentPanel.appendChild(div);
    });
}

// 文化セクションの投稿を表示する関数
function displayCulturePosts() {
    let culturePanel = document.getElementById('culture-panel');
    culturePanel.innerHTML = '';
    culturePosts.forEach(post => {
        let div = document.createElement('div');
        div.innerHTML = `<p><strong>${post.name}</strong>: ${post.comment}</p>`;
        culturePanel.appendChild(div);
    });
}

// 全体のコメント一覧を表示する関数
function displayComments() {
    let commentList = document.getElementById('comment-list');
    commentList.innerHTML = '';
    comments.forEach(comment => {
        let li = document.createElement('li');
        li.innerHTML = `<strong>${comment.name}</strong>: ${comment.content}`;
        commentList.appendChild(li);
    });
}
