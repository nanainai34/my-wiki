<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Upload and Comments</title>
</head>
<body>
    <h1>File Upload and Comments</h1>
    <input type="file" id="fileInput">
    <button onclick="displayFile()">Display File</button>
    <div id="fileContent"></div>

    <hr>

    <h2>Post a Comment</h2>
    <form id="commentForm">
        <label for="commentName">Name:</label>
        <input type="text" id="commentName" required><br><br>
        <label for="commentContent">Comment:</label><br>
        <textarea id="commentContent" rows="4" cols="50" required></textarea><br><br>
        <button type="submit">Post Comment</button>
    </form>

    <ul id="commentList"></ul>

    <script>
        // ファイルの表示
        function displayFile() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];

            if (file) {
                const reader = new FileReader();

                reader.onload = function(e) {
                    const fileContent = document.getElementById('fileContent');
                    fileContent.textContent = e.target.result;
                };

                reader.readAsText(file);
            } else {
                alert('No file selected.');
            }
        }

        // コメントの投稿
        document.getElementById('commentForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const name = document.getElementById('commentName').value;
            const content = document.getElementById('commentContent').value;

            if (name && content) {
                const comment = { name: name, content: content };
                addComment(comment);
                saveComment(comment);
                document.getElementById('commentForm').reset();
            } else {
                alert('Please enter both name and comment content.');
            }
        });

        // コメントの表示
        function addComment(comment) {
            const commentList = document.getElementById('commentList');
            const li = document.createElement('li');
            li.innerHTML = `<strong>${comment.name}</strong>: ${comment.content}`;
            commentList.appendChild(li);
        }

        // コメントの保存
        function saveComment(comment) {
            let comments = JSON.parse(localStorage.getItem('comments')) || [];
            comments.push(comment);
            localStorage.setItem('comments', JSON.stringify(comments));
        }

        // ページ読み込み時に保存されたコメントを表示
        document.addEventListener('DOMContentLoaded', function() {
            let comments = JSON.parse(localStorage.getItem('comments')) || [];
            comments.forEach(comment => {
                addComment(comment);
            });
        });
    </script>
</body>
</html>
