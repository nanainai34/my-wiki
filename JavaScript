<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Upload and Comments</title>
</head>
<body>
    <h1>File Upload and Comments</h1>
    <input type="file" id="fileInput">
    <button onclick="displayFile()">Display File</button>
    <div id="fileContent"></div>

    <hr>

    <h2>Post a Comment</h2>
    <form id="commentForm">
        <label for="commentName">Name:</label>
        <input type="text" id="commentName" required><br><br>
        <label for="commentContent">Comment:</label><br>
        <textarea id="commentContent" rows="4" cols="50" required></textarea><br><br>
        <button type="submit">Post Comment</button>
    </form>

    <ul id="commentList"></ul>

    <!-- Firebase JavaScript SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.9/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.9/firebase-database.js"></script>
    
    <script>
        // Firebase の設定
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            databaseURL: "YOUR_DATABASE_URL",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Firebase の初期化
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // ファイルの表示
        function displayFile() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];

            if (file) {
                const reader = new FileReader();

                reader.onload = function(e) {
                    const fileContent = document.getElementById('fileContent');
                    fileContent.textContent = e.target.result;
                };

                reader.readAsText(file);
            } else {
                alert('No file selected.');
            }
        }

        // コメントの投稿
        document.getElementById('commentForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const name = document.getElementById('commentName').value;
            const content = document.getElementById('commentContent').value;

            if (name && content) {
                const comment = { name: name, content: content };
                saveComment(comment);
                document.getElementById('commentForm').reset();
            } else {
                alert('Please enter both name and comment content.');
            }
        });

        // コメントの保存（Firebase に保存）
        function saveComment(comment) {
            const commentsRef = database.ref('comments');
            commentsRef.push(comment);
        }

        // コメントの表示（Firebase から取得）
        database.ref('comments').on('child_added', function(data) {
            const comment = data.val();
            addComment(comment);
        });

        // コメントの表示
        function addComment(comment) {
            const commentList = document.getElementById('commentList');
            const li = document.createElement('li');
            li.innerHTML = `<strong>${comment.name}</strong>: ${comment.content}`;
            commentList.appendChild(li);
        }
    </script>
</body>
</html>
