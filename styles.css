// ページ読み込み時に投稿内容を表示する
window.onload = function() {
    displaySection("history");
};

// セクションを切り替える関数
function displaySection(sectionId) {
    // 全てのコンテンツセクションを非表示にする
    let sections = document.querySelectorAll('.content-section');
    sections.forEach(section => {
        section.style.display = 'none';
    });

    // 指定されたセクションを表示する
    document.getElementById(sectionId).style.display = 'block';
}

// 投稿内容を保存するための関数
function savePost(type) {
    let name = document.getElementById(type + "-name").value;
    let content = document.getElementById(type + "-content").value;

    // ローカルストレージに保存する場合の例
    let posts = JSON.parse(localStorage.getItem(type + "-posts")) || [];
    let post = { name: name, content: content };
    posts.push(post);
    localStorage.setItem(type + "-posts", JSON.stringify(posts));

    // 表示更新
    displayPosts(type);
}

// 投稿内容を表示するための関数
function displayPosts(type) {
    let posts = JSON.parse(localStorage.getItem(type + "-posts")) || [];

    let panel = document.getElementById(type + "-panel");
    panel.innerHTML = ""; // 現在の内容をクリア

    posts.forEach((post, index) => {
        let postElement = document.createElement("div");
        postElement.classList.add("post");

        let nameElement = document.createElement("h3");
        nameElement.textContent = post.name;
        postElement.appendChild(nameElement);

        let contentElement = document.createElement("p");
        contentElement.textContent = post.content;
        postElement.appendChild(contentElement);

        // 削除ボタンを追加
        let deleteButton = document.createElement("button");
        deleteButton.textContent = "削除";
        deleteButton.addEventListener("click", function() {
            deletePost(type, index);
        });
        postElement.appendChild(deleteButton);

        panel.appendChild(postElement);
    });
}

// 投稿内容を削除する関数
function deletePost(type, index) {
    let posts = JSON.parse(localStorage.getItem(type + "-posts")) || [];
    posts.splice(index, 1);
    localStorage.setItem(type + "-posts", JSON.stringify(posts));

    // 表示更新
    displayPosts(type);
}

// フォームの投稿ボタンにイベントリスナーを設定する
document.getElementById("history-form").addEventListener("submit", function(event) {
    event.preventDefault();
    savePost("history");
});

document.getElementById("government-form").addEventListener("submit", function(event) {
    event.preventDefault();
    savePost("government");
});

document.getElementById("culture-form").addEventListener("submit", function(event) {
    event.preventDefault();
    savePost("culture");
});

// 各セクションのリンクをクリックしたときの挙動を設定する
document.querySelectorAll("nav ul li a").forEach(link => {
    link.addEventListener("click", function(event) {
        event.preventDefault();
        let sectionId = this.getAttribute("href").substring(1);
        displaySection(sectionId);
    });
});
